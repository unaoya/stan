---
title: "最尤推定の実験"
author: "梅崎直也"
date: "2019/4/27"
output: html_document
---

最尤推定をどのように行なっているか実験してみる。

ランダムにコインを取ってきて、そのコインの表の出る確率を推定するという実験を行う。

ランダムに選んだコインの表の出る確率を$\theta$とする。
これは一様分布から乱数生成する。
$\theta$の中身はこの時点では見ないことにしよう。
（現実的にもこれを知ることはできない。これをデータから推定したい）

この$\theta$を元にして、コインを$n$回振り、表の出た回数を$x$とする。
ここも二項分布から乱数生成する。
この結果は見てもよい。
（現実的にもこれはデータとして実際に得られる数値である。）

このデータとモデルを元にして尤度関数を計算し、そのグラフをプロットする。
最尤推定の結果は$x/n$になることが数学的に証明できる。

最後に答え合わせ。

$n$を変えてみると、推定結果が当たりやすくなる。

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r cars}
theta <- runif(1)

n <- 10
x <- rbinom(n=1, size=n, prob=theta)
x

f <- function(p){choose(n,x) * p^x * (1-p)^(n-x)}
plot(f, 0, 1)

theta
```

